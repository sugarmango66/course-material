<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.27">
    <title>REST API Authorization | Course Material</title><meta name="description" content="">
    <link rel="preload" href="/course-material/assets/js/runtime~app.f0ff5c47.js" as="script"><link rel="preload" href="/course-material/assets/css/styles.60e6ff5b.css" as="style"><link rel="preload" href="/course-material/assets/js/1812.04b2fb73.js" as="script"><link rel="preload" href="/course-material/assets/js/app.bb1e2481.js" as="script">
    <link rel="stylesheet" href="/course-material/assets/css/styles.60e6ff5b.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/course-material/" class=""><!----><span class="site-name">Course Material</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/course-material/" class="nav-link" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Courses"><span class="title">Courses</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Courses"><span class="title">Courses</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/course-material/courses/android-development/" class="nav-link" aria-label="Android Development 2022"><!--[--><!--]--> Android Development 2022 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/course-material/courses/client-server-communication/" class="nav-link" aria-label="Client-Server Communication 2019"><!--[--><!--]--> Client-Server Communication 2019 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/course-material/courses/git/" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/course-material/courses/introduction-to-script-programming/" class="nav-link" aria-label="Introduction to Script Programming 2021"><!--[--><!--]--> Introduction to Script Programming 2021 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/course-material/courses/web-development-advanced-concepts/" class="nav-link" aria-label="Web Development - Advanced Concepts 2022"><!--[--><!--]--> Web Development - Advanced Concepts 2022 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/course-material/courses/web-development-fundamentals/" class="nav-link" aria-label="Web Development Fundamentals 2021"><!--[--><!--]--> Web Development Fundamentals 2021 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/PeppeL-G/course-material/issues" rel="noopener noreferrer" target="_blank" aria-label="Get Help"><!--[--><!--]--> Get Help <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/course-material/" class="nav-link" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Courses"><span class="title">Courses</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Courses"><span class="title">Courses</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/course-material/courses/android-development/" class="nav-link" aria-label="Android Development 2022"><!--[--><!--]--> Android Development 2022 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/course-material/courses/client-server-communication/" class="nav-link" aria-label="Client-Server Communication 2019"><!--[--><!--]--> Client-Server Communication 2019 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/course-material/courses/git/" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/course-material/courses/introduction-to-script-programming/" class="nav-link" aria-label="Introduction to Script Programming 2021"><!--[--><!--]--> Introduction to Script Programming 2021 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/course-material/courses/web-development-advanced-concepts/" class="nav-link" aria-label="Web Development - Advanced Concepts 2022"><!--[--><!--]--> Web Development - Advanced Concepts 2022 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/course-material/courses/web-development-fundamentals/" class="nav-link" aria-label="Web Development Fundamentals 2021"><!--[--><!--]--> Web Development Fundamentals 2021 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/PeppeL-G/course-material/issues" rel="noopener noreferrer" target="_blank" aria-label="Get Help"><!--[--><!--]--> Get Help <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">REST API Authorization</p><ul class=""><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#lecture-material" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Lecture material"><!--[--><!--]--> Lecture material <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#recommended-reading" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Recommended reading"><!--[--><!--]--> Recommended reading <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#roles" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Roles"><!--[--><!--]--> Roles <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#resource-owner" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Resource Owner"><!--[--><!--]--> Resource Owner <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#client" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Client"><!--[--><!--]--> Client <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#resource-server" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Resource Server"><!--[--><!--]--> Resource Server <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#authorization-server" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Authorization Server"><!--[--><!--]--> Authorization Server <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#protocol-flow" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Protocol flow"><!--[--><!--]--> Protocol flow <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#client-registration" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Client Registration"><!--[--><!--]--> Client Registration <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#obtaining-access-token" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Obtaining Access Token"><!--[--><!--]--> Obtaining Access Token <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#resource-owner-password-credentials-grant" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Resource Owner Password Credentials Grant"><!--[--><!--]--> Resource Owner Password Credentials Grant <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#authorization-code-grant" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Authorization Code Grant"><!--[--><!--]--> Authorization Code Grant <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#implicit-grant" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Implicit Grant"><!--[--><!--]--> Implicit Grant <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#the-proof-key-for-code-exchange-extension" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="The Proof Key for Code Exchange extension"><!--[--><!--]--> The Proof Key for Code Exchange extension <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/course-material/lectures/rest-api-authorization/#client-credentials-grant" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Client Credentials Grant"><!--[--><!--]--> Client Credentials Grant <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="rest-api-authorization" tabindex="-1"><a class="header-anchor" href="#rest-api-authorization" aria-hidden="true">#</a> REST API Authorization</h1><p>Let&#39;s take a look at how users can login to accounts in our REST API.</p><iframe width="560" height="314" src="https://www.youtube.com/embed/0Ech5jpP1Dc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><h2 id="lecture-material" tabindex="-1"><a class="header-anchor" href="#lecture-material" aria-hidden="true">#</a> Lecture material</h2><ul><li><a href="rest-api-authorization.pdf">rest-api-authorization.pdf</a></li><li><a href="rest-api-authorization.pptx">rest-api-authorization.pptx</a></li></ul><h2 id="recommended-reading" tabindex="-1"><a class="header-anchor" href="#recommended-reading" aria-hidden="true">#</a> Recommended reading</h2><ul><li><a href="https://en.wikipedia.org/wiki/List_of_OAuth_providers" target="_blank" rel="noopener noreferrer">Wikipedia&#39;s List of OAuth providers<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a><ul><li>Notice that you find many of the big guys (Google, Microsoft, etc.) in the list.</li></ul></li><li><a href="https://tools.ietf.org/html/rfc6749" target="_blank" rel="noopener noreferrer">OAuth 2.0 Framework - RFC 6749<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a><ul><li>You need to read this specification to learn the details of the framework, which you have to know when adding support for OAuth 2.0 in your own app, or when using another app supporting OAuth 2.0.</li></ul></li><li><a href="https://oauth.net/2/" target="_blank" rel="noopener noreferrer">https://oauth.net/2/<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a><ul><li>If you think the specification is too hard to read to get the big picture, the resources on this website might be easier to understand.</li></ul></li></ul><h1 id="oauth-2-0" tabindex="-1"><a class="header-anchor" href="#oauth-2-0" aria-hidden="true">#</a> OAuth 2.0</h1><p>OAuth 2.0 is an authorization framework describing how you can give other applications access to your own users&#39; data (resources) stored in your application. Usually, big companies like Google are the ones who implement the framework, and we others instead create our own third-party applications in which we can access our users&#39; Google resources through the framework. When your own solution consists of your own client application and your own server application (such as an Android application and a web application exposing a REST API), you can use this framework in your server application for authorization too.</p><p>The main idea is that the client application obtains an Access Token from the server application, which gives the client application permission to access a user&#39;s resources that is stored on the server application (typically through a REST API). OAuth 2.0 specifies different ways this can be done.</p><h2 id="roles" tabindex="-1"><a class="header-anchor" href="#roles" aria-hidden="true">#</a> Roles</h2><p>To describe how it works, OAuth 2.0 first defines 4 different roles. You can think of these as 4 different actors, but they are called roles, probably because one and the same actor can have multiple roles at the same time.</p><h3 id="resource-owner" tabindex="-1"><a class="header-anchor" href="#resource-owner" aria-hidden="true">#</a> Resource Owner</h3><p>This is simply the user that is using the Client application and that have an account with associated resources on the server application.</p><h3 id="client" tabindex="-1"><a class="header-anchor" href="#client" aria-hidden="true">#</a> Client</h3><p>This is the application the user is using (for example an Android application), and this is the application that wants to access the user&#39;s resources on the server.</p><h3 id="resource-server" tabindex="-1"><a class="header-anchor" href="#resource-server" aria-hidden="true">#</a> Resource Server</h3><p>This is the server that stores and guards access to all the resources on the server. When a Client wants to access the user&#39;s resources, the Client will send HTTP requests to this server and pass along an Access Token as a proof of that the user has granted the Client access to her resources.</p><h3 id="authorization-server" tabindex="-1"><a class="header-anchor" href="#authorization-server" aria-hidden="true">#</a> Authorization Server</h3><p>This is the server the Resource Owner use to give a Client permission to access her resources on the Resource Server. This server typically generates Access Tokens the Client can use to access the user&#39;s resources on the Resource Server.</p><div class="custom-container tip"><p class="custom-container-title">Two servers?!</p><p>The roles Resource Server and Authorization Server can be hold by one and the same server application, typically a web application.</p></div><h2 id="protocol-flow" tabindex="-1"><a class="header-anchor" href="#protocol-flow" aria-hidden="true">#</a> Protocol flow</h2><span class="whole" data-v-6169d342><!----><span class="figureNumber" data-v-6169d342></span><!----></span> below gives an overview of how the Client can obtain and use an Access Token. All communication with the Authorization Server and the Resource Server are done using HTTP (HTTPS). When the Resource Owner needs to communicate with the Authorization Server, she will (most often, but not necessarily) do so using her web browser. <figure data-v-c2e176ba><!--[--><div class="mermaid" data-v-78c3786c></div><!--]--><figcaption data-v-c2e176ba>Overview of the protocol used in OAuth 2.0.</figcaption><span class="incrementFigureNumber" data-v-c2e176ba></span></figure><p>An Authorization Grant is simply something a Client can show to the Authorization Server to prove that the Resource Owner has granted the Client permission to access the Resource Owner&#39;s resources.</p><p>In some cases, the Authorization Server sends back the Access Token directly to the user (which the user then directly gives to the Client), instead of using the detour with an Authorization Grant.</p><h2 id="client-registration" tabindex="-1"><a class="header-anchor" href="#client-registration" aria-hidden="true">#</a> Client Registration</h2><p>In most cases, the Client needs to pre-register itself and be approved as a Client at the Authorization Server before it can request Access Tokens from it. This way, arbitrary (potentially evil) applications can&#39;t request Access Tokens from it.</p><p>When the Client registers itself it will receive a <code>client_id</code> and <code>client_secret</code> it can use to authenticate itself to the Authorization Server. <code>client_secret</code> should of course be kept secret. Additional information about the Client can also be provided in the registration process, such as which URIs that can be used to identify the Client application.</p><h2 id="obtaining-access-token" tabindex="-1"><a class="header-anchor" href="#obtaining-access-token" aria-hidden="true">#</a> Obtaining Access Token</h2><p>OAuth 2.0 describes 4 different flows clients can use to obtain an Access Token. With time, some of these flows have been found to contain security vulnerabilities and have been deprecated, and new and more secure flows have been created. <a href="https://oauth.net/2.1/" target="_blank" rel="noopener noreferrer">OAuth 2.1<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> will contain the most up-to-date information about which flows that are best to use, but at the moment that&#39;s just a draft, and should not be seen as a reliable source of truth.</p><h3 id="resource-owner-password-credentials-grant" tabindex="-1"><a class="header-anchor" href="#resource-owner-password-credentials-grant" aria-hidden="true">#</a> Resource Owner Password Credentials Grant</h3><p>This flow is the most straight forward and easiest flow to understand. It can be used when you are the owner of the both the server that implements OAuth 2.0 and the Client, i.e. when the Client is a first-party application, and not a third-party application. For example, the YouTube app for smartphones can use this to flow to let users login with their Google accounts, since Google owns and develop the YouTube app.</p><p>This flow does not require the Client to first register itself at the Authorization Server, so this flow does not make use of <code>client_id</code> and <code>client_secret</code>. Also, no Authorization Grant is used, so the user directly obtains an Access Token from the Authorization Server.</p><span class="whole" data-v-6169d342><!----><span class="figureNumber" data-v-6169d342></span><!----></span> below gives an overflow of the flow. For implementation details (which HTTP requests to send/responses to receive), check out the specification. <figure data-v-c2e176ba><!--[--><div class="mermaid" data-v-78c3786c></div><!--]--><figcaption data-v-c2e176ba>The flow of the Resource Owner Password Credentials Grant.</figcaption><span class="incrementFigureNumber" data-v-c2e176ba></span></figure><p>The obvious drawback with this flow is that the user reveals her credentials (username and password) to the Client, which the whole point of this framework is to avoid, so this is really not a good flow to use. But as long as the Client comes from the same company that developed the server application, there&#39;s should be no danger in doing that, since the Client company already know the users&#39; credentials.</p><div class="custom-container warning"><p class="custom-container-title">This flow has been deprecated</p><p>This flow has been deprecated. The reason is that this flow reveals the user&#39;s username and password to the Client, which the whole idea with this authorization framework is to prevent, and you can avoid that using other flows. Rather see this flow as a &quot;shortcut flow&quot; that existed in the beginning, and not a &quot;proper flow&quot;.</p><p>If you from scratch build your own client and server application that you want to secure with OAuth 2.0, using this flow can be an acceptable option, since it&#39;s so easy to implement support for. But Google and other big OAuth 2.0 providers should definitely not use it. The risk is that an evil Client app (and not only Google&#39;s own apps) asks for the user&#39;s Google username and Google password, and if the user enters them, the evil Client app has come over the user&#39;s credentials, which is bad. It&#39;s better if the user always enters her credentials directly to the Authorization Server, and never exposes them to the Client.</p></div><h3 id="authorization-code-grant" tabindex="-1"><a class="header-anchor" href="#authorization-code-grant" aria-hidden="true">#</a> Authorization Code Grant</h3><p>This flow is the de-facto standard flow to use in OAuth 2.0. It is particularly used when the Client is a web application. The Authorization Grant used is in this flow is an <em>Authorization Code</em>.</p><span class="whole" data-v-6169d342><!----><span class="figureNumber" data-v-6169d342></span><!----></span> below gives an overflow of the flow. For implementation details (which HTTP requests to send/responses to receive), check out the specification. <figure data-v-c2e176ba><!--[--><div class="mermaid" data-v-78c3786c></div><!--]--><figcaption data-v-c2e176ba>The flow of the Authorization Code Grant.</figcaption><span class="incrementFigureNumber" data-v-c2e176ba></span></figure><div class="custom-container tip"><p class="custom-container-title">Why so complicated?!</p><p>Why does the Authorization Server first send back an Authorization Code, which the Client then needs to trade for an Access Token, instead of sending back the Access Token directly?</p><p>This is done to expose the Access Token as little as possible (i.e. only to the Client). Since the user is (most often) using her web browser to communicate with the Authorization Server, if the Authorization Server would send back the Access Token directly, and the user would have installed a bad browser extension, that browser extension would maybe be able to read the Access Token (depending on which permissions the extension has been granted). That browser extension would then be able to access the user&#39;s resources using the Access Token, and this is bad.</p><p>Since the Authorization Server now instead only sends back an Authorization Code, that bad extension won&#39;t be able to do anything bad, since exchanging it for an Access Token also requires the <code>client_secret</code>, which only the Client knows.</p></div><p>This flow can also be used for Clients where the user has access to the source code (single-page applications, smartphone applications, desktop applications, etc.), but in these cases, the Client to Authorization Server communication will not include the <code>client_secret</code> (since users would be able to read it in the code), so the Client won&#39;t authenticate itself to the Authorization Server, which makes this flow a little bit less secure. But these applications can use this flow with the Proof Key for Code Exchange extension to make it a bit more secure. Read more about this extension further down.</p><h3 id="implicit-grant" tabindex="-1"><a class="header-anchor" href="#implicit-grant" aria-hidden="true">#</a> Implicit Grant</h3><p>The flow Authorization Code Grant (with the Proof Key for Code Exchange extension) can these days be used in most cases. There exists an old flow called Implicit Grant, which simplified the Authorization Code Grant flow by sending back an Access Token directly, instead of taking the detour with the Authorization Code. The Implicit Grant flow was intended to be used by single-page applications. Since they run in the web browser, taking the detour with the Authorization Code makes no sense, since the Access Token will be exposed to the web browser in the end any way. Single-page applications could also have difficulties with exchanging the Authorization Code for an Access Token because of web browsers&#39; Same-Origin Policy, making this flow their only option, but that&#39;s usually not a problem these days.</p><span class="whole" data-v-6169d342><!----><span class="figureNumber" data-v-6169d342></span><!----></span> below gives an overflow of the flow. For implementation details (which HTTP requests to send/responses to receive), check out the specification. <figure data-v-c2e176ba><!--[--><div class="mermaid" data-v-78c3786c></div><!--]--><figcaption data-v-c2e176ba>The flow of the Implicit Grant.</figcaption><span class="incrementFigureNumber" data-v-c2e176ba></span></figure><div class="custom-container warning"><p class="custom-container-title">This flow has been deprecated</p><p>This flow has been deprecated. The reasons are the security vulnerabilities explained in <a href="https://tools.ietf.org/html/draft-ietf-oauth-security-topics-09" target="_blank" rel="noopener noreferrer">OAuth 2.0 Security Best Current Practice<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> for this flow.</p><p>For one, the Access Token is passed to the Client through the URL in the web browser, and any (evil) library used in the single-page application will be able to read the Access Token that way. By using the detour with the Authorization Code in the Authorization Code Grant flow instead, an evil library in the single-page application will just be able to read the Authorization Code, which is less useful than the Access Token.</p></div><h3 id="the-proof-key-for-code-exchange-extension" tabindex="-1"><a class="header-anchor" href="#the-proof-key-for-code-exchange-extension" aria-hidden="true">#</a> The Proof Key for Code Exchange extension</h3><p>When a smartphone app use the Authorization Code Grant flow, the user needs to be taken back to the smartphone app (the Client) after the Authorization Server has sent back an Authorization Code to the user. For this to work, the smartphone app can on the user&#39;s device register URLs that should open the Client when used, and the Authorization Server will send back an HTTP redirect response to that URL, which then will cause the device to open the Client application.</p><p>However, any smartphone app can register these URLs. An evil smartphone app can therefor register that it should be opened when a URL with an Authorization Code is used that is really intended for another Client, and that way come over the Authorization Code.</p><p>To prevent this, and to make Authorization Codes less valuable on their own, the Proof Key for Code Exchange extension was introduced to the Authorization Code Grant flow.</p><p>With this extension, when the Client wants the Resource Owner to ask the Authorization Server to generate an Authorization Code for it, the Client first:</p><ol><li>Generates a random string called the <code>code_verifier</code></li><li>Computes the <code>code_challenge</code> by hashing the <code>code_verifier</code> using <a href="https://en.wikipedia.org/wiki/SHA-2" target="_blank" rel="noopener noreferrer">SHA256<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li></ol><p>Then in the Resource Owner&#39;s request to the Authorization Server to generate an Authorization Code, it also passes along the <code>code_challenge</code> to the Authorization Server, which the Authorization Server then remembers.</p><p>Then, when the Client has obtained the Authorization Code and want&#39;s to exchange it for an Access Token, it also needs to pass along the <code>code_verifier</code> in the request. The Authorization Server will hash the <code>code_verifier</code> using SHA256, and if the hash value doesn&#39;t match the <code>code_challenge</code> it received before, it won&#39;t accept the exchange. This way, only the true Client can exchange the Authorization Code for an Access Token, because no one else knows which valid <code>code_verifier</code> to send to the Authorization Server in the exchange request.</p><span class="whole" data-v-6169d342><!----><span class="figureNumber" data-v-6169d342></span><!----></span> below gives an overflow of the flow. For implementation details (which HTTP requests to send/responses to receive), check out the specifications. <figure data-v-c2e176ba><!--[--><div class="mermaid" data-v-78c3786c></div><!--]--><figcaption data-v-c2e176ba>The flow of the Authorization Code Grant.</figcaption><span class="incrementFigureNumber" data-v-c2e176ba></span></figure><h3 id="client-credentials-grant" tabindex="-1"><a class="header-anchor" href="#client-credentials-grant" aria-hidden="true">#</a> Client Credentials Grant</h3><p>This flow can be used when the Client wants to obtain an Access Token it can use to access its own resources on the Resource Server (if you ever have a use-case for that). Since it uses <code>client_id</code> and <code>client_secret</code> you should only use this when the Client runs on a server, so your users won&#39;t have access to the source code and can read the <code>client_secret</code>.</p><figure data-v-c2e176ba><!--[--><div class="mermaid" data-v-78c3786c></div><!--]--><figcaption data-v-c2e176ba>The flow of the Client Credentials Grant.</figcaption><span class="incrementFigureNumber" data-v-c2e176ba></span></figure><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/PeppeL-G/course-material/edit/master/src/lectures/rest-api-authorization/README.md" rel="noopener noreferrer" target="_blank" aria-label="Improve this page!"><!--[--><!--]--> Improve this page! <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">1/16/2022, 7:02:31 PM</span></div><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/course-material/assets/js/runtime~app.f0ff5c47.js" defer></script><script src="/course-material/assets/js/1812.04b2fb73.js" defer></script><script src="/course-material/assets/js/app.bb1e2481.js" defer></script>
  </body>
</html>
