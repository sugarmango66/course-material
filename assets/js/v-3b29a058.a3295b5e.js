"use strict";(self.webpackChunkcourse_material=self.webpackChunkcourse_material||[]).push([[9512],{7447:(e,s,n)=>{n.r(s),n.d(s,{default:()=>ie});var t=n(6252);const a=(0,t._)("h1",{id:"web-sessions",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#web-sessions","aria-hidden":"true"},"#"),(0,t.Uk)(" Web Sessions")],-1),i=(0,t._)("p",null,"A session is something a web application can use to remember information about a user, similiar to cookies, but unlike cookies, sessions are stored on the server.",-1),o=(0,t._)("h2",{id:"what-is-a-session",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#what-is-a-session","aria-hidden":"true"},"#"),(0,t.Uk)(" What is a session?")],-1),r=(0,t._)("p",null,"A session is a collection of key-value pairs stored on the server that belongs to a specific client (each client has its own session on the server). A server can use a session to remember information about a client. A session is quite similar to a collection of cookies, but clients can't read or write the key-value pairs in the session; only the server can read and write the key-value pairs in the session. So if the server puts a value in a client's session, it can be sure that that value is valid (it can't be changed by anyone except the server itself).",-1),l=(0,t.Uk)(" below shows an example of how a session can be used to remember a client's name. "),c=(0,t.uE)('<h2 id="how-long-does-a-session-exist" tabindex="-1"><a class="header-anchor" href="#how-long-does-a-session-exist" aria-hidden="true">#</a> How long does a session exist?</h2><p>The session only exists &quot;as long as the user use the website&quot;. In many web frameworks, a session only exists for 20 minutes (can usually be configured), but each time the user visits a new page on the website, those 20 minutes are &quot;refreshed&quot;, and the session will continue to live for 20 minutes again. That means if you start to use a website, you get a new session the server can use to remember information about you, and if you don&#39;t send a new HTTP request within 20 minutes, that session will be deleted, and the server will forget all the information it had stored about you in your session. With the next HTTP request you send to the server after 20 minutes, you will get a new session.</p><div class="custom-container tip"><p class="custom-container-title">Example</p><p>You might have noticed that if you login on a website, start reading a long page for ~30 minutes, and then go to another page on the website, that you are not logged in anymore? That&#39;s because the session has been deleted since you haven&#39;t been active on (sent HTTP request to) that website for a while. It&#39;s not a bug; it&#39;s supposed to work like this.</p></div><h2 id="what-are-sessions-used-for" tabindex="-1"><a class="header-anchor" href="#what-are-sessions-used-for" aria-hidden="true">#</a> What are sessions used for?</h2><p>So, when you need to remember information about a client, you can use either cookies or sessions. When should you use which one? A rule of thumb is that you should use sessions if you need to remember temporary information about a client the client should not have access to. Otherwise, a cookie might be the better choice.</p><div class="custom-container tip"><p class="custom-container-title">Example</p><p>If you need to remember which account a client has logged in to, then you should remember this in the client&#39;s session, because you don&#39;t want the client to be able to change this information.</p></div><div class="custom-container tip"><p class="custom-container-title">Example</p><p>If you want to remember which words the user has searched for in the search form on your website, then you might be better of storing that information in a cookie. The user only harms herself by modifying the cookie, and by using a cookie, we can remember that information for a much longer time compared to using a session.</p><p>One downside with using a cookie in this example is that the cookie will be passed to the server with every single request the client makes. For cookies containing little data, this is probably not a problem, but if the cookie contains a lot of data, this might slow down the performance, and it will increase the user&#39;s data usage, which is bad if the user has a limited data plan.</p></div><h2 id="how-are-sessions-implemented" tabindex="-1"><a class="header-anchor" href="#how-are-sessions-implemented" aria-hidden="true">#</a> How are sessions implemented?</h2><p>Session might sound complicated, but they are most often very easy to use, because the framework/libraries we use have implemented a nice interface for us through which we can use sessions without having to bother about the details ourselves.</p><p>How the server store the session on the server is up to the server to decide. It could store the sessions in temporary files, or it could store the sessions in a database. Web programmers usually don&#39;t need to worry about this, because the framework/libraries we use takes care of this for us.</p><p>The trickiest part with sessions is for the server to figure out a way to remember which session that belongs to which client. Lucky for us, experienced developers have already found a good way doing this using cookies, but for us to understand why that way is as complicated as it is, let&#39;s try to find a way on our own first!</p><h3 id="identifying-clients" tabindex="-1"><a class="header-anchor" href="#identifying-clients" aria-hidden="true">#</a> Identifying clients</h3><p>So, first we need to be able to uniquely identify clients. We need a unique identifier for each client to be able to map the sessions stored on the server to individual clients.</p><p>When using HTTP, it is very tempting to use the client&#39;s IP address as the unique identifier for the client, because the Internet is built on that each computer connected to the Internet should have its own unique IP address! But there is a number of problems with this approach.</p><h4 id="ip-problem-1-ip-addresses-are-re-used" tabindex="-1"><a class="header-anchor" href="#ip-problem-1-ip-addresses-are-re-used" aria-hidden="true">#</a> IP problem 1: IP addresses are re-used</h4>',15),u=(0,t.Uk)("IP addresses are re-used. So if Alice connects her computer to the Internet and get the IP address "),h=(0,t._)("code",null,"1.2.3.4",-1),p=(0,t.Uk)(", and then login on the website "),d=(0,t._)("code",null,"bank.com",-1),m=(0,t.Uk)(", she would get a session there that remembers that she has logged in to the "),b=(0,t._)("code",null,"Alice",-1),k=(0,t.Uk)(" account, and that session is connected to her IP address "),_=(0,t._)("code",null,"1.2.3.4",-1),f=(0,t.Uk)(". If she then disconnects from the Internet, someone else will receive that IP address. Let's say Bob starts and connect his computer to the Internet, and now Bob gets the IP address "),g=(0,t._)("code",null,"1.2.3.4",-1),w=(0,t.Uk)(". Then if Bob sends HTTP requests to "),v=(0,t._)("code",null,"bank.com",-1),y=(0,t.Uk)(", he would take over the session that was created for Alice, and he would now be logged in to her account! This is visualized in "),S=(0,t.Uk)(" below."),U=(0,t._)("p",null,"This way, Bob can try to repeatedly connect and disconnect his computer to the Internet to get a new IP address all the time, and each time he also sends a request to the server about transferring money from the logged in account to his own account. Not often, but sometimes he will take over a session from someone who just used the server and still have an active session there!",-1),I=(0,t._)("p",null,"So, IP addresses are not good unique identifiers for clients, because they will change over time.",-1),x=(0,t._)("h4",{id:"ip-problem-2-ip-addresses-can-be-guessed",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#ip-problem-2-ip-addresses-can-be-guessed","aria-hidden":"true"},"#"),(0,t.Uk)(" IP Problem 2: IP addresses can be guessed")],-1),T=(0,t._)("p",null,"The problem described above is actually not only a problem when a client disconnects from the Internet. The way the Internet Protocol works (which is also true for the HTTP protocol, since it's built on the Internet Protocol) is that each computer should write its own IP address in all messages it sends to another computer. However, there's no way to check if a client actually has put its own IP address in the message, so nothing stops a hacker from using another IP address",-1),A=(0,t.Uk)("When a client uses another IP address as its own, the client won't be able to receive the HTTP response from the server, but that is not needed if the attack is about getting the server to carry out a side effect of some kind (like transferring money from the logged in account to another account). This is visualized in "),P=(0,t.Uk)(" below."),q=(0,t._)("p",null,"This way, Bob can try to repeatedly generate new IP addresses and send requests to transfer money from the logged in account to his own account. Not often, but sometimes he will use an IP address with an active session on the server, and the transfer will succeed.",-1),W=(0,t._)("h4",{id:"the-solution",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#the-solution","aria-hidden":"true"},"#"),(0,t.Uk)(" The solution")],-1),H=(0,t._)("p",null,[(0,t.Uk)("We can't use IP addresses to uniquely identify clients. Instead, we will generate a unique identifier for each client. Now, it's important that we don't generate the identifiers starting with 1, and then increment by 1, so we would get 1, 2, 3, and so one, or similar. The reason is the same as the one described in "),(0,t._)("em",null,"IP Problem 2"),(0,t.Uk)("; hackers can easily guess these identifiers and send their own requests to the server using them.")],-1),B=(0,t._)("p",null,[(0,t.Uk)("So, the identifiers needs to be hard to guess for hackers. Therefor one typically use long strings consisting of random characters as the identifier, so one client could get the identifier "),(0,t._)("code",null,"204dc1145c4545f094208a077f8fa9d4"),(0,t.Uk)(", and another client could get the identifier "),(0,t._)("code",null,"12fa3f48e3314cf2869884345e8543ef"),(0,t.Uk)(". It is extremely unlikely a hacker would manage to generate his own identifier that would identify an active session this way.")],-1),E=(0,t.Uk)("Further more, these identifiers does now not really identify individual clients, but we will instead use them to identify individual sessions. Therefor these identifiers are called "),C=(0,t._)("em",null,"session ids",-1),N=(0,t.Uk)(". This is visualized in "),j=(0,t.Uk)(" below."),O=(0,t.uE)('<h2 id="when-are-sessions-created" tabindex="-1"><a class="header-anchor" href="#when-are-sessions-created" aria-hidden="true">#</a> When are sessions created?</h2><p>There are different strategies the server can use to decide when is should create the session for a new client. One strategy is to create the session as soon as it receives a request from a new client. This way each client is guaranteed to always have its own session. But this is a bit wasteful when the server has clients it doesn&#39;t need to remember anything about.</p><p>Another strategy is to create a new session for the client the first time the server needs to remember something about that client. This way, no empty sessions will exist. Furthermore, ðŸ˜ƒ</p><p>Which strategy you want to use can usually be configured in the framework/library you use to work with the sessions.</p><h2 id="anything-special-to-think-about-when-using-sessions" tabindex="-1"><a class="header-anchor" href="#anything-special-to-think-about-when-using-sessions" aria-hidden="true">#</a> Anything special to think about when using sessions?</h2><h3 id="sdfsdfsd" tabindex="-1"><a class="header-anchor" href="#sdfsdfsd" aria-hidden="true">#</a> sdfsdfsd</h3><p>Since sessions usually use cookies to remember which session that belongs to which client, you need to consider the cookie law and the GDPR.</p><p>...</p><h3 id="securing-the-session-id" tabindex="-1"><a class="header-anchor" href="#securing-the-session-id" aria-hidden="true">#</a> Securing the session id</h3><p>The session id is really important. Use HTTPS.</p><h3 id="clients-can-create-new-sessions" tabindex="-1"><a class="header-anchor" href="#clients-can-create-new-sessions" aria-hidden="true">#</a> Clients can create new sessions</h3><p>Clients can easilly create new sessions. By sending an HTTP request to the server that doesn&#39;t contain a session id, the server will create a new session for the client. Because of this, you often can&#39;t use the session to keep track of things you want to forbid the client to do.</p><div class="custom-container tip"><p class="custom-container-title">Example</p><p>If you use a counter to keep track of how many times a user has failed to login to an account, and prevent the client from login in to an account when the counter reaches a specific number (e.g. 5 failed login attempts), then you can&#39;t store the counter in the session, because the user can easilly send a new HTTP request to the server without a session id, and then get a new session where the counter is 0 again.</p></div><h2 id="using-sessions-in-practise" tabindex="-1"><a class="header-anchor" href="#using-sessions-in-practise" aria-hidden="true">#</a> Using sessions in practise</h2>',14),L=(0,t.Uk)("Express does not have built-in support for sessions, but it can easily be added through a middleware function from the "),Y={href:"https://github.com/expressjs/session",target:"_blank",rel:"noopener noreferrer"},D=(0,t.Uk)("express-session"),G=(0,t.Uk)(" package."),R=(0,t._)("ol",null,[(0,t._)("li",null,[(0,t.Uk)("Install the "),(0,t._)("code",null,"express-session"),(0,t.Uk)(" package by running the command "),(0,t._)("code",null,"npm install express-session"),(0,t.Uk)(" in your project folder.")]),(0,t._)("li",null,[(0,t.Uk)("Add middleware function with session support from the "),(0,t._)("code",null,"express-session"),(0,t.Uk)(" package in your code, e.g.:")])],-1),$=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" express "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'express'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" expressSession "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'express-session'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" app "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"express"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// Add the middleware function from express-session."),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token function"},"expressSession"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token comment"},"// Let's cover these options later..."),(0,t.Uk)("\n\tsecret"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'some characters no one can guess...'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\tresave"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"false"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n\tsaveUninitialized"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// Use app as before..."),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br")])],-1),F=(0,t._)("p",null,[(0,t.Uk)("When we call "),(0,t._)("code",null,"expressSession"),(0,t.Uk)(" we get back a middleware function that we add to our express application object. This middleware will add the "),(0,t._)("code",null,"session"),(0,t.Uk)(" property to the "),(0,t._)("code",null,"request"),(0,t.Uk)(" objects we have. If we want to store a value in the client's session, then we simply add that value to this object, e.g. "),(0,t._)("code",null,'request.session.theKey = "The value"'),(0,t.Uk)(". If we want to read out a value we have previosuly stored in the session, then we simply read it out from this object, e.g. "),(0,t._)("code",null,"const theValue = request.session.theKey"),(0,t.Uk)(".")],-1),z=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"Example"),(0,t._)("p",null,"Below is an example of code that in the session stores number of times the user has visisted a specific page."),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"/count-visits"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("request"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" response")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t\n\t"),(0,t._)("span",{class:"token comment"},"// If we haven't put the counter in the session before,"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token comment"},"// that means the user is visiting this page for the"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token comment"},"// first time, and we need to create the counter."),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"!"),(0,t.Uk)("request"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("session"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("counter"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t\trequest"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("session"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("counter "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"0"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\t\n\t"),(0,t._)("span",{class:"token comment"},"// Increment the counter by one."),(0,t.Uk)("\n\trequest"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("session"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("counter "),(0,t._)("span",{class:"token operator"},"+="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"1"),(0,t.Uk)("\n\t\n\tresponse"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"You have visited this page "'),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)("request"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("session"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("counter"),(0,t._)("span",{class:"token operator"},"+"),(0,t._)("span",{class:"token string"},'" times."'),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\t\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br")])]),(0,t._)("p",null,[(0,t.Uk)("The first time a user sends a GET request to "),(0,t._)("code",null,"/count-visits"),(0,t.Uk)(", she will get back the text "),(0,t._)("em",null,"You have visited this page 1 times."),(0,t.Uk)(". The second time she sends the same request, she will get back the text "),(0,t._)("em",null,"You have visited this page 2 times."),(0,t.Uk)(", and so on. Notice that each user will have their own counter (because each user will get its own session).")])],-1),K=(0,t._)("p",null,"When you create the session middleware function, you can configure it by passing it an object with options. There are three mandatory options.",-1),M=(0,t._)("p",null,[(0,t.Uk)("The "),(0,t._)("code",null,"secret"),(0,t.Uk)(" option is a value used to generate the session ids. It doesn't matter what you use here as long as no one can figure it out. If a hacker knows which secret you are using, she might be able to figure out which session ids your users will get, and can then easilly hijack (take over) their sessions (send HTTP request with the same session id, so the server think the requests are sent from the user the session belongs to), which is a major security vulnerability.")],-1),V=(0,t._)("p",null,[(0,t.Uk)("The "),(0,t._)("code",null,"resave"),(0,t.Uk)(" option...")],-1),Z=(0,t._)("p",null,[(0,t.Uk)("The "),(0,t._)("code",null,"saveUninitialized"),(0,t.Uk)(" option...")],-1),J=(0,t._)("p",null,":::",-1),Q=(0,t._)("p",null,[(0,t.Uk)('PHP has built-in support for sessions, but to use them you first need to "activate them" by calling the function '),(0,t._)("code",null,"session_start()"),(0,t.Uk)(". You need to call this function each time you receive an HTTP request, and it will create a new session for the client if the client doesn't have one, or re-use the existing one the client already have.")],-1),X=(0,t._)("p",null,[(0,t.Uk)("When you have called "),(0,t._)("code",null,"session_start()"),(0,t.Uk)(" you can use the special variable "),(0,t._)("code",null,"$_SESSION"),(0,t.Uk)(" to write values to the session and to retrieve values from the session. For example, to add a new value to the session you would use "),(0,t._)("code",null,'$_SESSION["theKey"] = "The value";'),(0,t.Uk)(", and to obtain a value from the session you would use "),(0,t._)("code",null,'$theValue = $_SESSSION["theKey"];'),(0,t.Uk)(".")],-1),ee=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"Example"),(0,t._)("p",null,"Here is an example of a PHP page that counts how many times the user have fetched it."),(0,t._)("div",{class:"language-php ext-php line-numbers-mode"},[(0,t._)("pre",{class:"language-php"},[(0,t._)("code",null,[(0,t._)("span",{class:"token php language-php"},[(0,t._)("span",{class:"token delimiter important"},"<?php"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token function"},"session_start"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// If no counter exists in the session, create it."),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"!"),(0,t._)("span",{class:"token keyword"},"isset"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token variable"},"$_SESSION"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string single-quoted-string"},"'counter'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token variable"},"$_SESSION"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string single-quoted-string"},"'counter'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// Increment the counter in the session."),(0,t.Uk)("\n"),(0,t._)("span",{class:"token variable"},"$_SESSION"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string single-quoted-string"},"'counter'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"+="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"echo"),(0,t.Uk)(),(0,t._)("span",{class:"token string double-quoted-string"},'"You have visisted this page "'),(0,t._)("span",{class:"token operator"},"."),(0,t._)("span",{class:"token variable"},"$_SESSION"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string single-quoted-string"},"'counter'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token operator"},"."),(0,t._)("span",{class:"token string double-quoted-string"},'" times."'),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token delimiter important"},"?>")]),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br")])]),(0,t._)("p",null,[(0,t.Uk)("The first time a user visits the page, she will get back the text "),(0,t._)("em",null,"You have visited this page 1 times."),(0,t.Uk)(". The second time she sends the same request, she will get back the text "),(0,t._)("em",null,"You have visited this page 2 times."),(0,t.Uk)(", and so on. Notice that each user will have their own counter (because each user will get its own session).")])],-1),se=(0,t._)("p",null,":::",-1),ne=(0,t._)("h2",{id:"a-note-on-stateless",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#a-note-on-stateless","aria-hidden":"true"},"#"),(0,t.Uk)(" A Note on Stateless")],-1),te=(0,t._)("p",null,"Depending on where you store your sessions, your web application either become statefull or remain stateless, and this affects how hard it will be to scale your web application in the future. We will not get into the details of scaling here, but be aware of that if the sessions are stored on the same server that is running your web application (for example in files, which is the case when using the default configuration of PHP), your application becomes statefull and a bit harder to scale. If you instead store the sessions in a database running on a separate sever, your web application remain stateless and is a bit easier to scale.",-1),ae={},ie=(0,n(3744).Z)(ae,[["render",function(e,s){const n=(0,t.up)("FigureNumber"),ae=(0,t.up)("RenderMermaid"),ie=(0,t.up)("Figure"),oe=(0,t.up)("OutboundLink"),re=(0,t.up)("CodeGroupItem"),le=(0,t.up)("CodeGroup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[a,i,o,r,(0,t.Wm)(n),l,(0,t.Wm)(ie,{caption:"Example of Server using session to remember information from a client."},{default:(0,t.w5)((()=>[(0,t.Wm)(ae,{"graph-definition":"\nsequenceDiagram\n\t\tparticipant Client as Client A\n\t\tparticipant Server\n\t\tparticipant Session as Client A Session\n\t\tClient->>+Server: 1. HTTP Request: My name's Alice\n\t\tServer->>+Session: 2. Store name=Alice\n\t\tNote right of Session: name=Alice\n\t\tSession->>-Server: 3. Stored!\n\t\tServer--\x3e>-Client: 4. HTTP Response: Hi Alice!\n\t\tClient->>+Server: 5. HTTP Request: What is my name?\n\t\tServer->>+Session: 6. Get name\n\t\tSession->>-Server: 7. Alice\n\t\tServer--\x3e>-Client: 6. HTTP Response: Your name is Alice!\n"})])),_:1}),c,(0,t._)("p",null,[u,h,p,d,m,b,k,_,f,g,w,v,y,(0,t.Wm)(n),S]),(0,t.Wm)(ie,{caption:"Example of why using IP addresses to identify clients are bad."},{default:(0,t.w5)((()=>[(0,t.Wm)(ae,{"graph-definition":"\nsequenceDiagram\n\t\tparticipant Bob\n\t\tparticipant Alice\n\t\tparticipant Server\n\t\tparticipant Session as Alice Session\n\t\tAlice->>Alice: Connect computer to Internet, get IP 1.2.3.4\n\t\tAlice->>+Server: Login, ip=1.2.3.4, username=Alice, password=abc123\n\t\tServer->>Server: checkCredentials(Alice, abc123)\n\t\tServer->>+Session: Store ip=1.2.3.4, loggedInAccount=Alice\n\t\tNote right of Session: ip=1.2.3.4, loggedInAccount=Alice\n\t\tSession->>-Server: Stored!\n\t\tServer--\x3e>-Alice: Login successful!\n\t\tAlice->>Alice: Disconnect computer from Internet\n\t\tBob->>Bob: Connect computer to Internet, get IP 1.2.3.4\n\t\tBob->>+Server: Transfer money, ip=1.2.3.4, to=Bob, amount=100\n\t\tServer->>+Session: Get loggedInAccount ip=1.2.3.4\n\t\tSession->>-Server: Alice\n\t\tServer->>Server: transfer(from=Alice, to=Bob, amount=100)\n\t\tServer--\x3e>-Bob: Transfer successful!\n"})])),_:1}),U,I,x,T,(0,t._)("p",null,[A,(0,t.Wm)(n),P]),(0,t.Wm)(ie,{caption:"Example of why using IP addresses to identify clients are bad."},{default:(0,t.w5)((()=>[(0,t.Wm)(ae,{"graph-definition":"\nsequenceDiagram\n\t\tparticipant Bob\n\t\tparticipant Alice\n\t\tparticipant Server\n\t\tparticipant Session as Alice Session\n\t\tAlice->>Alice: Connect computer to Internet, get IP 1.2.3.4\n\t\tAlice->>+Server: Login, ip=1.2.3.4, username=Alice, password=abc123\n\t\tServer->>Server: checkCredentials(Alice, abc123)\n\t\tServer->>+Session: Store ip=1.2.3.4, loggedInAccount=Alice\n\t\tNote right of Session: ip=1.2.3.4, loggedInAccount=Alice\n\t\tSession->>-Server: Stored!\n\t\tServer--\x3e>-Alice: Login successful!\n\t\tBob->>Bob: Connect computer to Internet, get IP 9.8.7.6\n\t\tBob->>+Server: Transfer money, ip=1.2.3.4, to=Bob, amount=100\n\t\tServer->>+Session: Get loggedInAccount ip=1.2.3.4\n\t\tSession->>-Server: Alice\n\t\tServer->>Server: transfer(from=Alice, to=Bob, amount=100)\n\t\tServer--\x3e>-Bob: Transfer successful!\n"})])),_:1}),q,W,H,B,(0,t._)("p",null,[E,C,N,(0,t.Wm)(n),j]),(0,t.Wm)(ie,{caption:"Example of why using IP addresses to identify clients are bad."},{default:(0,t.w5)((()=>[(0,t.Wm)(ae,{"graph-definition":"\nsequenceDiagram\n\t\tparticipant Alice\n\t\tparticipant Server\n\t\tparticipant Session as Alice Session\n\t\tAlice->>+Server: Login, username=Alice, password=abc123\n\t\tServer->>Server: checkCredentials(Alice, abc123)\n\t\tServer->>+Session: Store loggedInAccount=Alice\n\t\tNote right of Session: id=204dc1..., loggedInAccount=Alice\n\t\tSession->>-Server: Stored, id=204dc1...!\n\t\tServer--\x3e>-Alice: Login successful, sessionId=204dc1...\n\t\tNote left of Alice: sessionId=204dc1...\n\t\tAlice->>+Server: Transfer money, sessionId=204dc1..., to=Claire, amount=100\n\t\tServer->>+Session: Get loggedInAccount id=204dc1...\n\t\tSession->>-Server: Alice\n\t\tServer->>Server: transfer(from=Alice, to=Claire, amount=100)\n\t\tServer--\x3e>-Alice: Transfer successful!\n"})])),_:1}),O,(0,t.Wm)(le,null,{default:(0,t.w5)((()=>[(0,t.Wm)(re,{title:"Express"},{default:(0,t.w5)((()=>[(0,t._)("p",null,[L,(0,t._)("a",Y,[D,(0,t.Wm)(oe)]),G]),R,$,F,z])),_:1}),K,M,V,Z,J,(0,t.Wm)(re,{title:"PHP"},{default:(0,t.w5)((()=>[Q,X,ee])),_:1}),se])),_:1}),ne,te],64)}]])},3744:(e,s)=>{s.Z=(e,s)=>{const n=e.__vccOpts||e;for(const[e,t]of s)n[e]=t;return n}},4554:(e,s,n)=>{n.r(s),n.d(s,{data:()=>t});const t={key:"v-3b29a058",path:"/lectures/web-sessions/",title:"Web Sessions",lang:"en-US",frontmatter:{sidebar:"auto",navbarTitle:"Web Sessions"},excerpt:"",headers:[{level:2,title:"What is a session?",slug:"what-is-a-session",children:[]},{level:2,title:"How long does a session exist?",slug:"how-long-does-a-session-exist",children:[]},{level:2,title:"What are sessions used for?",slug:"what-are-sessions-used-for",children:[]},{level:2,title:"How are sessions implemented?",slug:"how-are-sessions-implemented",children:[{level:3,title:"Identifying clients",slug:"identifying-clients",children:[]}]},{level:2,title:"When are sessions created?",slug:"when-are-sessions-created",children:[]},{level:2,title:"Anything special to think about when using sessions?",slug:"anything-special-to-think-about-when-using-sessions",children:[{level:3,title:"sdfsdfsd",slug:"sdfsdfsd",children:[]},{level:3,title:"Securing the session id",slug:"securing-the-session-id",children:[]},{level:3,title:"Clients can create new sessions",slug:"clients-can-create-new-sessions",children:[]}]},{level:2,title:"Using sessions in practise",slug:"using-sessions-in-practise",children:[]},{level:2,title:"A Note on Stateless",slug:"a-note-on-stateless",children:[]}],filePathRelative:"lectures/web-sessions/README.md",git:{updatedTime:163025196e4}}}}]);
//# sourceMappingURL=v-3b29a058.a3295b5e.js.map